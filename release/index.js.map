{"version":3,"file":"index.js","sources":["../src/useFormikSideEffects.ts","../src/FormikSideEffects.tsx"],"sourcesContent":["import React from 'react';\r\nimport { FormikContext } from 'formik';\r\n\r\nexport type SideEffects<T> = (currentValues: T, previousValues: T) => T | null;\r\n\r\nexport const useFormikSideEffects = <T extends {}>(\r\n  determineSideEffect: SideEffects<T>,\r\n  currentFormik: FormikContext<T>\r\n) => {\r\n  var previous = React.useRef(currentFormik);\r\n\r\n  React.useEffect(() => {\r\n    const previousFormik = previous.current;\r\n\r\n    if (previousFormik.values !== currentFormik.values) {\r\n      const sideEffect = determineSideEffect(\r\n        currentFormik.values,\r\n        previousFormik.values\r\n      );\r\n\r\n      if (sideEffect) {\r\n        currentFormik.setValues(sideEffect);\r\n      }\r\n    }\r\n\r\n    previous.current = currentFormik;\r\n  }, [determineSideEffect, currentFormik]);\r\n};\r\n","import React from 'react';\r\nimport { FormikConsumer, FormikContext } from 'formik';\r\nimport { useFormikSideEffects, SideEffects } from './useFormikSideEffects';\r\n\r\ntype FormikSideEffectProps<T> = {\r\n  determineSideEffects: SideEffects<T>;\r\n};\r\n\r\nconst FormikSideEffectChild = <T extends {}>({\r\n  determineSideEffects: determineSideEffect,\r\n  formik\r\n}: FormikSideEffectProps<T> & {\r\n  formik: FormikContext<T>;\r\n}) => {\r\n  useFormikSideEffects<T>(determineSideEffect, formik);\r\n  return null;\r\n};\r\n\r\nexport const FormikSideEffects = <T extends {}>({\r\n  determineSideEffects\r\n}: FormikSideEffectProps<T>) => (\r\n  <FormikConsumer>\r\n    {formik => (\r\n      <FormikSideEffectChild\r\n        determineSideEffects={determineSideEffects}\r\n        formik={formik}\r\n      />\r\n    )}\r\n  </FormikConsumer>\r\n);\r\n"],"names":["useFormikSideEffects","determineSideEffect","currentFormik","previous","React","useRef","useEffect","previousFormik","current","values","sideEffect","setValues","FormikSideEffectChild","ref","FormikConsumer","formik","determineSideEffects"],"mappings":"gGAKaA,WACXC,EACAC,OAEIC,EAAWC,EAAMC,OAAOH,GAE5BE,EAAME,yBACEC,EAAiBJ,EAASK,WAE5BD,EAAeE,SAAWP,EAAcO,OAAQ,KAC5CC,EAAaT,EACjBC,EAAcO,OACdF,EAAeE,QAGbC,GACFR,EAAcS,UAAUD,GAI5BP,EAASK,QAAUN,GAClB,CAACD,EAAqBC,KClBrBU,WAAuCC,UAM3Cb,mCACO,yCAGuCa,uCAG9CT,gBAACU,+BACEC,UACCX,gBAACQ,GACCI,qBAAsBA,EACtBD,OAAQA"}